---
sidebar_position: 1
---

# Specification

## Overview
Codigo Generator is a set of tools and engines to generate “Smart Contracts” stubs, Client code and documentation from a **Codigo’s Interface Description Language** or **CIDL** file.

“**Smart Contract**” stubs are generated in full source, verified and audited, code. Developers will need to only implement the business logic for each stub, avoiding the repetitive boilerplate code for validation, verification and parsing.

**Client Code** generation supports multiple programming languages. It takes a **CIDL** as input and generates full client compilable code. The client code includes all the necessary elements to call the Smart Contract methods through the underlying Blockchain.

Interacting with a Smart Contract is already possible via the RPC interfaces exposed by Blockchains Clients and Validators. However, writing the boilerplate code that translates a programming language construct into RPC calls and back is time consuming, prone to errors  and brittle - implementation bugs and security vulnerabilities can only be detected during runtime.

## Goals

Codigo’s main goal is to speed Blockchain adoption by enabling Developers to focus on their business logic while Codigo Generator takes care of all the rest.

1. **Generates “Smart Contract” boilerplate and stubs**
Codigo Generator abstracts all the initialization, validation, verification and parsing for each incoming request, and routes the call to the specific stub method with all parameters validated and sanitized.

2. **Generates Client Libraries**
Codigo Generators simplifies Smart Contract adoption by generating “Smart Contract” client libraries in multiple programming languages. Method calls are abstracted behind a simple API interface. All the boilerplate code to generate the actual Blockchain Smart Contract call is automatically generated by Codigo Generators for each programming language. 

3. **Documentation**
Codigo Generators creates full Smart Contract documentation based on the CIDL file.
This documentation will list all exposed methods by the Smart Contract and input parameters. For Account based VMs, like Solana, full account structure is documented as well.
The details of the documentation are an integral part of the CIDL file.

## High Level Schematic Diagram

| ![High Level Schematic Diagram](../../static/img/high_level_schematic_diagram.png) |
|:----------------------------------------------------------:|

## Codigo’s Interface Description Language CIDL
CIDL is a work in progress, open initiative to standardize how Smart Contracts Interfaces and data structures are described. Similar to OpenAPI ( Swagger ) for Web2 RESTful API design.

The Codigo Interface Description Language defines a, programming language-agnostic, interface description for Smart Contract Interfaces and custom data types, which allows both humans and computers to discover and understand the capabilities of a Smart Contract without requiring access to source code, additional documentation, or reverse engineering. The CIDL Specification removes guesswork in calling a Smart Contract.

## CIDL Schema Definition

:::caution
Work in Progress!!!
:::

```yaml
cidl: CIDL version
info:
  name: smart contract name 
  title: title or name of the smart contract
  version: version of the smart contract
  summary: smart contract description summary
  contact:
    name: contact name | company
    web: url of company | support
    email: email of contact | support
    git: git URL
  license:
    name: license name
    identifier: SPDX license expression
    url: license URL

imports: # Array external CIDLs
- ref: name | name to be referenced inside this document. 
  loc: url [ local file system, https, github ]
  progid: pubkey | ID of the Program generated by the external CIDL

types:
  <type-name>: # Identifier for this Structure
    summary: type description summary
    solana: 
      owner: Owner's program id; Expected Owner of the account
      seeds: # Array of seeds
    fields: # Array of fields
    - name: field name
      type:  [native, extended]
      description: field description
      format: # The format of this field: [date-time, key, etc]  
      attributes: # [max: nn, min: nn]
      solana:
        attributes: # [cap: nn]

methods: # Array of methods | instructions
- name: method name 
  version: version of this method
  summary: description of this API
  solana:
  signers: # Array of signers
inputs: # Array of inputs
  - name: # The Input parameter name
    type: [native, type, extended]
    description: short description of this input parameter
    solana: # Solana extension for this input
      attributes: [mut, init, init_if_needed]
      seeds: # Array of params refs
      rent-payer: # A valid signer other than fee-payer

errors: # Array - Custom Errors definition
- id: Error identifier
  msg: Error message 
```

### General Section
In this section the developer defines Smart Contract general settings, such as Smart Contract Name, Version and a full description of the Smart Contract capabilities to be parsed by the Documentation Generator.

### CIDL

| CIDL | String | ***Required*** [Semantic version](https://docs.npmjs.com/about-semantic-versioning) of the specification used in the document |
|------|--------|---------------------------------------------------------------------|

**CIDL Sample**
```
cidl: '0.1'
```

## Info

### Info Schema (Required)

```
info:
  name: smart contract name 
  title: title or name of the smart contract
  version: version of the smart contract
  summary: smart contract description summary
  contact:
    name: contact name | company
    web: url of company | support
    email: email of contact | support
    git: git URL
  license:
    name: license name
    identifier: SPDX license expression
    url: license URL
```

### Info Object 

| **Field Name** | **Type**         | **Notes**                                                                                      |
|----------------|------------------|------------------------------------------------------------------------------------------------|
| **name**       | String           | **Required** The Contract name. This name can be used as reference                                          |
| **title**      | String \| Markup | **Required** The title will be used to generate Documentation for the Smart contract defined in this CIDL   |
| **version**    | String           | **Required** [Semantic version](https://docs.npmjs.com/about-semantic-versioning) of the specification used in this document                                    |
| **summary**    | String \| Markup | **Recommended** The summary will be used to generate Documentation for the Smart contract defined in this CIDL |
| **contact**    | Object           | **Optional**                                                                                   |
| **license**    | Object           | **Optional**                                                                                   |

### Contact Object

The contact object defines the Owner of the CIDL and its contact information

| **Field Name** | **Type**               | **Notes**                                                                        |
|----------------|------------------------|----------------------------------------------------------------------------------|
| **name**       | String                 | **Optional** Name of this CIDL maintainer. It can represent an individual or an organization. |
| **web**        | URL                    | **Optional** Website url of the CIDL maintainer.                                              |
| **email**      | String \| email format | **Optional**                                                                     |
| **git**        | String \| git URL      | **Optional** Git URL of this CIDL repository                                         |
                                                                |
### License Object
This object defines the license governing this CIDL.

| **Field Name** | **Type**      | **Notes**                                                                 |
|----------------|---------------|---------------------------------------------------------------------------|
| **name**       | String        | **Required** The license name used for the CIDL.                                       |
| **identifier** | String        | **Optional** An [SPDX](https://spdx.org/spdx-specification-21-web-version#h.jxpfx0ykyb60) license expression for the API.                                   |
| **url**        | String \| URL | **Optional** A URL to the license used for the API. This MUST be in the form of a URL. |

:::info
Between identifier and url, only one is required.
:::

### Info Object Sample

```
info: # Smart Contract Information
  name: LamportTransfer
  title: Transfer Lamports between 2 accounts
  version: '0.5'
  summary: |
    # Welcome to the Transfer Program
    This Program **Transfers** Lamport between two Solana Accounts
  contact: # Contact information of the creator
    name: 123 Transfer LLC
    web: https://123Transfer.com/support
    email: support@123transfer.com
    git: https://github.com/123transfer
  license: # License of the Smart Contract Code
    name: Apache 2.0
    identifier: Apache-2.0
``` 

## Imports

This section defines how to import external CIDL to be reused while defining a new interface.
External CIDL locations can be versioned, to lock a specific version of a CIDL, or generic, pointing to the latest version ( not recommended ). To be supported in future versions.

### Imports Schema (Optional)

```
imports: # Array external CIDLs
- ref: name | name to be referenced inside this document. 
  loc: url [ local file system, https, github ] 
```

### Imports Array

| **imports** | Array [Import Object] | **Optional** |
|-------------|-----------------------|--------------|

### Import Object

| **Field Name** | Type          | Notes                                                                                                                                                                               |
|----------------|---------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **ref**        | String        | **Required** Reference name. Used as a prefix when an element of this CIDL is used locally. Each ref has to be unique                                                                            |
| **loc**            | String \| URL | **Required** Location of the CIDL. The location can be: Local File System, URL (GitHub, HTTP), CIDL Hub. Locations can include a version indicator to lock the external CIDL to a stable version |
| **solana**         | object        | **Optional** Extensions needed to support the Solana Blockchain                                                                                                                                  |

### Solana Object 

| Field Name | Type                  | Notes                                                                             |
|------------|-----------------------|-----------------------------------------------------------------------------------|
| progid     | String Format: pubkey | The Program ID ( as a Public Key ) of the Program generated by the imported CIDL. |

### Imports Sample

```
imports: # Array external CIDLs
- ref: token # The Token Program
  loc: https://github.com/codigoai/cidls/token@version
  progid: TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb
- ref: nftcore # NFT Core Smart Program
  loc: cidl://nftcore@v2 # CIDL Hub
  progid: NFTpsVeCiPHMUAtzQWZw7RjsKjgCjhwU55QGu4U1Szw

methods:
- transfer:
  version: 1.0
  summary: transfer for a token account
  inputs:
  - name: srcAccount
    type: token.TokenAccount       # Referencing an imported CIDL
    description: source account
```

## Types

This section defines new Data Structures. These structures are referenced by methods. In this current version we support only Accounts types.

### Types Schema (Optional)

```
types:
  <type-name>: # Identifier for this Structure
    summary: account description summary
    solana: 
      owner: Owner's program id; Expected Owner of the account
      seeds: # Array of seeds
    fields: # Array of fields
    - name: field name
      type:  [native, extended]
      description: field description
      format: # The format of this field: [date-time, key, etc]  
      attributes: # [max: nn, min: nn]
      solana:
        attributes: # [cap: nn]
```

### Types Map

| Field Name | Type                           | Notes                                                                             |            |
|------------|--------------------------------|-----------------------------------------------------------------------------------|
| types      | Map [ type name, type object ] | This section is optional. SmartContract may work on existing, native or extended, data types |

### Type-name Key

| Type name &lt;type-name&gt; | String It has to comply with the Smart Contract Data Structure naming policies. | The Type name is, the key to the type object map, is used to identify the data structure within the Method definition. This identifier will also become the name for the SmartContract Data Structure to be referenced within the code. |
|-----------------------|---------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|

### Type Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **summary**    | String \| markup | **Recommended** Documentation summary of the Data Structure |
| **solana**     | Solana Extension Object for Type           | **Optional** (relevant if Target Blockchain is Solana) To define Solana Extensions for this Data Structure. This defined the Structure as a Solana Account |
| **fields**     | Array [Field Object] | **Required** |

### Solana Extension Object for Type

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **owner**    | String \| sol: pubkey | *To be supported in future versions:* **Optional** The Program identifier( Pubkey) that Owns this Account. Codigo will add runtime checks to validate that the right account’s owner matches this field. If this field is ignored or set as **self**, the check is done with the current program id.|
| **seeds**    | Array [Seed Object] | **Optional** Required for PDA accounts. |

### Seed Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **name**    | fixed string | **Required** Seed name could be interpreted as: a seed name with a type, a fixed string seed value |
| **type**    | Account reference \| native type | **Optional** Seed type definition |

### Fields Array 
The Field array field is required even if it has a single entry. Future reviews may include simple Type Definitions for single entry types

### Field Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **name**    | String | **Required** The name of the field |
| **type**    | String | **Required** Data types supported by this version of the CIDL: **Native Types**: Native primitive data types. **Extended Types**: Built in extended types implemented by Codigo. |
| **format**    | String | *To be supported in future versions:* **Optional** Represents the internal format of the field. For example a String can represent a **date, an email address or a url**. Extended types can also be used to represent Blockchain Accounts, PublicKeys, etc. |
| **attributes**    | [&lt;attr name: attr value&gt;] | *To be supported in future versions:* **Optional** See Native Types table for supported attributes |
| **description**| String \| Markup  | **Recommended** Field description in markup |
| **solana**    | Solana Extension Object for Field | **Optional** (relevant if Target Blockchain is Solana) To define Solana Extensions for this Data Structure. This defined the Structure as a Solana Account |

### Solana Extension Object for Field

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **attributes**    | Array [Attribute] | **Optional** Where Attribute is a string following this format: attr-name: attr-value. The only supported attribute is cap:nnn, which is required for types vec, string, opt&lt;string&gt;. See Type Extensions table for supported attributes |

## Methods

The Method Section describes the interface signature for each instruction exposed by the Smart Contract.

### Methods Schema (Required)

```
methods: # Array of methods | instructions
- name: method name 
  version: version of this method
  summary: description of this API
  solana:
    signers: # Array of signers
  inputs: # Array of inputs
  - name: # The Input parameter name
    type: [native, type, extended]
    description: short description of this input parameter
    solana: # Solana extension for this input
      attributes: [mut, init, init_if_needed]
      seeds: # Array of params refs
      rent-payer: # A valid signer other than fee-payer
```

### Method Array

| **methods** | Array [Method Object] | **Required** |
|-------------|-----------------------|--------------|

### Method Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **name**    | String \| Method name It has to comply with the Smart Contract method/functions naming policies.| **Required** |
| **version**    | String | **Recommended** Semantic version of the specification used in this document  |
| **summary**    | String \| Markup | **Optional** Documentation summary of the Data Structure |
| **solana**     | Solana Extension Object for Method           | **Optional** (relevant if Target Blockchain is Solana) To define Solana Extensions for this Data Structure. |
| **inputs**    | Array [Input Object] | **Optional** |

### Solana Extension Object For Method

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **signers**    | Array [Signer Object] | **Optional** Defines names for the accounts of received signatures. The first signer name will be the one assigned to fee-paying account. Because of that, it can't have a custom account type. Also, when its name is not specified "feePayer" will be used as name. |

### Signer Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **name**    | String | **Required** The name for the signing account. If the signer name coincides with an input name, it is assumed the input will be the signer. |
| **type**    | String | **Optional** Setting a type in the signer makes the program perform the account checks in the signing account. If a signer's name matches an input with type, the input's type will be checked. |
| **executable**    | boolean | **Optional** Setting a signer as executable, indicates the account refers to a Solana program. |
| **address**    | String | **Optional** When an address is specified the signer will be required to match it. |

### Input Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **name**    | String | **Required** The input name. This name is used to generate source code. It will be used as the Method parameters. |
| **type**    | String | **Required** Data types supported by this version of the CIDL: **Native Types**: Native primitive data types. **Types**: Types defined in this or external CIDL. **Extended Types**: Built in extended types implemented by Codigo. |
| **solana**    | Solana Extension Object for Input | **Optional** (relevant if Target Blockchain is Solana) To define Solana Extensions for this Data Structure. |
| **description**    | String | **Recommended** Documents the input parameter. This description is used to document in source code and while building the Web Documentation. |

:::note
To reference external types the type field  is created by adding the Import “ref” as prefix.

ref.type

Where ref is the import ref field and type is the name of the type from the imported CIDL.

 I.e. To reference Type record from CIDL with reference user, the type is created as:

user.record
:::

:::info
For Solana, if the type is a StructureID it represents a Solana Account, where the input is a Solana PubKey.
:::

### Solana Extension Object for Input


| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **attributes**    | Array [Attribute] | **Optional** |
| **seeds**    | Map[seed-name, seed-value] | **Optional** Allows user map seeds to inputs. Currently seed-value must be the name of another input. Only applies for accounts. |
| **rent-payer**    | String | **Optional** When the input is an Account to be created (ie: "init" or init-if-needed" attribute is present) the rent-payer will be the signer in charge of paying the rent for the account creation. If it is not specified, the fee-payer will be used. |

### Solana Object for Input 

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **attribute**    | string | **Required** If parameter type is an Account, the following attributes apply: **mut**: account is writable. **init**: account initialized in each transaction. Initialization is rent exempt. **init-if-needed**: account initialized if not exists yet. Initialization is rent exempt. |

### Seeds Map

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **seed-name**    | String | **Optional** If a seed-name for the account doesn't appear in the map, it will be automatically generated as an extra parameter in the sdk instruction call. When a seed-name is defined, it lets the user define where its value will be taken from. |
| **Input-name**    | String | **Required** The value must be the name of the input where to take seed's value from. In this case, seed's type must match the inputs' type. *To be supported in future versions:* The input-name may instead refer to a signer. |

## Errors

This section defines how to allow users to include personalized error messages associated to their business logic.

### Errors Schema (Optional)
```
errors: # Array - Custom Errors definition
- id: Error identifier
  msg: Error message 
```

### Errors Array

| **errors** | Array [Error Object] | *To be supported in future versions:* **Optional** |

### Error Object

| Field Name | Type             | Notes                                       |
|------------|------------------|---------------------------------------------|
| **id**    | String | **Required** |
| **msg**    | String | **Required** |

### Errors Sample

```
errors: # Array - Custom Errors definition
- id: 001
  msg: not enough balance
- id: 002
  msg: source account does not exist
- id: 003
  msg: target account does not exist
```

## Built In Types

### Native Types

This work in progress table describes the built in native types supported by this specification. Translation to actual Programming Languages types will be added in followup up reviews.

| **CIDL Native Type** | **Attributes** | **Notes** |
|----------------------|----------------|-----------|
| **Int8, int16, int32, int64, int128**           |                |           |
| **uint8, uint16, uint32, uint64, uint128**           |                |           |
| **float32, float64**           |      min,max          | Types supported *To be supported in future versions:* Minimum and Maximum attributes |
| **string**           |      cap:nnn          |   Text Require the Capacity attribute when used in a type    |
| **bytes**           |     cap:nnn           |   *To be supported in future versions:* Sequence of bytes. Requires the Capacity attribute when used in a type  |

### Type Extensions

Type extensions are custom data types. In this revision of the document, type extensions are built-in into the generator. Future revisions may add custom made Type Extensions.

They are identified by a prefix identifier, a colon and the name of the type, i.e. **mytype:signature**.

### Rust Type Extension

Prefix Identifier: **rs ( Rust )**

This work in progress table describes the built in extended types supported by this specification. Translation to actual Programming Languages types will be added in followup up reviews.

| **CIDL Extended Type** | **Attributes** | **Notes** |
|------------------------|----------------|-----------|
| **rs:option&lt;native&gt;**          |     cap:nnn           |   Requires the Capacity attribute when used with native type string in a type definition        |
| **rs:vec&lt;num*-native&gt;**          |    cap:nnn            |  num*=numeric+bool Requires the Capacity attribute when used in a type definition   |

### Solana Type Extension
Prefix Identifier: **sol**

| **CIDL Extended Type** | **Attributes** | **Notes** |
|------------------------|----------------|-----------|
| **sol:pubkey**          |                |   Pubkey is a Solana specific Structure in Rust        |












#### Documentation detectives wanted! If you've spotted any gaps or have suggestions to level up our documentation game, we'd love to hear from you!

[![Button Example]][Link]

[Link]: https://docs.google.com/forms/d/e/1FAIpQLSe8juhl22lxyvNi54GN_TX4yzooxOq5qE98sxh2CXhFxO9Dyw/viewform

[Button Example]: https://img.shields.io/badge/Feedback-FD971F?style=for-the-badge